### Data Generator

data_generator <- function(P = 10,
                           V = 100,
                           R = 2,
                           a = 1,
                           W = 2,
                           c = 1,
                           Q = 5,
                           s = 1,
                           n = 100){
  #############################################################################
  # Active Regions Selection
  #############################################################################
  xi      <- rep(0, P)
  xi[1:Q] <- 1
  
  #############################################################################
  # B Coefficients
  #############################################################################
  # C Sub-Structure
  C <- matrix(data = 0,
              nrow = V,
              ncol = P)
  for(p in 1:P){
    C[1:W, p] <- c 
  }
  # B
  B <- matrix(data = NA,
              nrow = V,
              ncol = P)
  for(p in 1:P){
    B[, p] <- xi[p] * C[, p]
  }
  
  #############################################################################
  # Theta Coefficients
  #############################################################################
  # U Sub-Structure
  U <- matrix(data = a,
              nrow = R,
              ncol = P)
  for(p in 1:P){
    U[, p] <- xi[p] * U[, p]
  }
  # Theta
  Theta       <- t(U) %*% U
  diag(Theta) <- 0
  
  #############################################################################
  # Covariates
  #############################################################################
  # A
  A <- array(data = rnorm(n    = n * P * P,
                          mean = 0,
                          sd   = 1),
             dim  = c(n, P, P))
  for(i in 1:n){
    diag(A[i,,]) <- 0
  }
  # G
  G <- array(data = rnorm(n    = n * V * P,
                          mean = 0,
                          sd   = 1),
             dim  = c(n, V, P))
  
  #############################################################################
  # Response Variable
  #############################################################################
  y <- numeric(length = n)
  for(i in 1:n){
    y[i] <- sum(G[i,,] * B) + sum(A[i,,] * Theta) / 2 +
      rnorm(n = 1, mean = 0, sd = s)
  }
  
  #############################################################################
  # Signal to Noise Ratio
  #############################################################################
  sigNoi <- Q * W * c^2 + Q * (Q - 1) * a^4 * R^2 / 4 + s
  sigNoi <- sigNoi / s
  
  # Returns the Data
  return(list(xi     = xi,
              C      = C,
              B      = B,
              U      = U,
              Theta  = Theta,
              A      = A,
              G      = G,
              y      = y,
              sigNoi = sigNoi))
}